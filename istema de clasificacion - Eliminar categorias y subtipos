warning: in the working copy of 'src/lib/classifier.ts', LF will be replaced by CRLF the next time Git touches it
[1mdiff --git a/src/lib/classifier.ts b/src/lib/classifier.ts[m
[1mindex 97dac4f..0c334c3 100644[m
[1m--- a/src/lib/classifier.ts[m
[1m+++ b/src/lib/classifier.ts[m
[36m@@ -83,8 +83,6 @@[m [masync function retryWithDifferentKey<T>([m
 interface ClassificationResult {[m
   id: string;[m
   tipo: 'buff' | 'nerf' | 'actualizaci√≥n';[m
[31m-  categoria: string;[m
[31m-  subtipo: string;[m
   summary: string;[m
   relevance: number;[m
 }[m
[36m@@ -99,10 +97,6 @@[m [mfunction validateClassification(result: any): result is ClassificationResult {[m
   [m
   return ([m
     validTypes.includes(result.tipo) &&[m
[31m-    typeof result.categoria === 'string' &&[m
[31m-    result.categoria.length > 0 &&[m
[31m-    typeof result.subtipo === 'string' &&[m
[31m-    result.subtipo.length > 0 &&[m
     typeof result.summary === 'string' &&[m
     result.summary.length > 0 &&[m
     Number.isInteger(result.relevance) &&[m
[36m@@ -131,7 +125,7 @@[m [masync function classifyItems(data: PromptData[]): Promise<ClassificationResult[][m
     }).join('\n\n---\n\n');[m
 [m
     const prompt = `[m
[31m-Eres un analista legislativo ULTRA-CR√çTICO que clasifica cambios normativos espa√±oles seg√∫n su RELEVANCIA NACIONAL REAL y CATEGORIZA cada documento seg√∫n el tipo de publicaci√≥n del BOE.[m
[32m+[m[32mEres un analista legislativo ULTRA-CR√çTICO que clasifica cambios normativos espa√±oles seg√∫n su RELEVANCIA NACIONAL REAL.[m
 [m
 ‚ö†Ô∏è CR√çTICO: S√© ESTRICTO pero EQUILIBRADO. El 80% de documentos del BOE son cambios administrativos menores, pero algunos s√≠ tienen impacto sectorial o nacional.[m
 [m
[36m@@ -142,81 +136,6 @@[m [mCRITERIOS DE CLASIFICACI√ìN:[m
 [m
 üî¥ REGLA EQUILIBRADA: Si un documento tiene impacto sectorial significativo o afecta a grupos amplios, puede ser BUFF/NERF. Solo ACTUALIZACI√ìN si es puramente administrativo.[m
 [m
[31m-üìã CATEGOR√çAS DEL BOE (clasifica cada documento en UNA categor√≠a y subtipo):[m
[31m-[m
[31m-1. **Normas y disposiciones generales**[m
[31m-   Subtipos: Ley, ProyectoLey, Anteproyecto, RealDecretoLey, RealDecreto, Decreto, OrdenMinisterial, Reglamento, Ordenanza[m
[31m-   Ejemplos: Ley de presupuestos, Real Decreto regulatorio, Orden ministerial[m
[31m-[m
[31m-2. **Disposiciones administrativas / actos generales**[m
[31m-   Subtipos: Circular, Instruccion, ResolucionGeneral, Acuerdo, NotaInformativa[m
[31m-   Ejemplos: Circulares de la administraci√≥n, instrucciones internas[m
[31m-[m
[31m-3. **Actos individuales / resoluciones**[m
[31m-   Subtipos: Nombramiento, Cese, ConcesionIndividual, SancionIndividual, ResolucionAdministrativa[m
[31m-   Ejemplos: nombramientos de personal, resoluciones de subvenci√≥n individual[m
[31m-[m
[31m-4. **Anuncios, edictos y notificaciones p√∫blicas**[m
[31m-   Subtipos: Edicto, Notificacion, AnuncioRegistroCivil, AnuncioJudicial, Subasta[m
[31m-   Ejemplos: edictos de subastas, notificaciones a desconocidos[m
[31m-[m
[31m-5. **Contrataci√≥n p√∫blica y compras**[m
[31m-   Subtipos: ConvocatoriaLicitacion, Pliego, Adjudicacion, Contratos, Suministros[m
[31m-   Ejemplos: anuncios de concursos p√∫blicos, adjudicaciones de contratos[m
[31m-[m
[31m-6. **Convocatorias y empleo p√∫blico**[m
[31m-   Subtipos: ConvocatoriaOposicion, BasesSelectivas, ResultadosSeleccion, ListasReservas[m
[31m-   Ejemplos: oferta de empleo p√∫blico, listas definitivas de aprobados[m
[31m-[m
[31m-7. **Subvenciones, ayudas y prestaciones**[m
[31m-   Subtipos: ConvocatoriaAyuda, BasesSubvencion, ResolucionConcesion, Reintegro[m
[31m-   Ejemplos: convocatorias de ayudas, resoluciones de concesi√≥n[m
[31m-[m
[31m-8. **Fiscalidad, presupuestos y cuentas p√∫blicas**[m
[31m-   Subtipos: Presupuestos, ModificacionPresupuestaria, OrdenTasas, CircularFiscal[m
[31m-   Ejemplos: cuentas generales, modificaciones presupuestarias[m
[31m-[m
[31m-9. **Registros oficiales y mercantiles / Propiedad**[m
[31m-   Subtipos: RegistroMercantil, RegistroPropiedad, InscripcionPatente, Marca[m
[31m-   Ejemplos: asientos registrales, publicaciones de constituci√≥n de sociedades[m
[31m-[m
[31m-10. **Jurisprudencia y actos de los √≥rganos jurisdiccionales**[m
[31m-    Subtipos: Sentencia, Auto, Providencia, ComunicadoTribunal[m
[31m-    Ejemplos: resoluciones publicadas por tribunales[m
[31m-[m
[31m-11. **Normativa y actos internacionales / UE**[m
[31m-    Subtipos: DirectivaUE, ReglamentoUE, Tratado, AcuerdoInternacional, DecisionComunitaria[m
[31m-    Ejemplos: trasposici√≥n de directivas, publicaci√≥n de tratados[m
[31m-[m
[31m-12. **Correcciones, rectificaciones y notas aclaratorias**[m
[31m-    Subtipos: CorreccionErrores, Rectificacion, Aclaracion[m
[31m-    Ejemplos: correcci√≥n de erratas en normas o anuncios previos[m
[31m-[m
[31m-13. **Informes, estudios y estad√≠sticas oficiales**[m
[31m-    Subtipos: InformeTecnico, Memoria, EstadisticaOficial, Dictamen[m
[31m-    Ejemplos: informes de ministerios, memorias de actividad[m
[31m-[m
[31m-14. **Transparencia, control y fiscalizaci√≥n**[m
[31m-    Subtipos: CuentaAnual, InformeAuditoria, DeclaracionPatrimonial, AcuerdoPleno[m
[31m-    Ejemplos: cuentas de organismos, informes de interventor√≠a[m
[31m-[m
[31m-15. **Asuntos mercantiles y de procedimientos concursales**[m
[31m-    Subtipos: ConcursoAcreedores, NombramientoAdministradorConcursal, AnuncioConcursal[m
[31m-[m
[31m-16. **Comunicados institucionales y actos protocolarios**[m
[31m-    Subtipos: DeclaracionInstitucional, ProtocoloVisita, NombramientoHonorifico[m
[31m-[m
[31m-17. **Publicidad legal y comerciales obligatorias**[m
[31m-    Subtipos: AvisoLegal, PublicacionConvocatoriaSociedad, LiquidacionSocietaria[m
[31m-[m
[31m-18. **Medidas urgentes y de emergencia**[m
[31m-    Subtipos: EstadoAlarma, EstadoExcepcion, MedidaEmergencia, SuspensionTemporal[m
[31m-    Ejemplos: decretos emergencia sanitaria, medidas extraordinarias[m
[31m-[m
[31m-19. **Otros / Varios**[m
[31m-    Subtipos: Misc, InformacionSectorial, BoletinInterno[m
[31m-    Uso: para publicaciones at√≠picas que no encajen en las anteriores[m
[31m-[m
 ESCALA DE RELEVANCIA (1-100) - EQUILIBRADA:[m
 - **95-100**: Reformas constitucionales, presupuestos generales del Estado, leyes org√°nicas fundamentales[m
   Ejemplo: "Ley Org√°nica de reforma del C√≥digo Penal" ‚Üí 97[m
[36m@@ -297,8 +216,6 @@[m [mResponde √öNICAMENTE con JSON v√°lido (sin markdown, sin explicaciones):[m
     {[m
       "id": "ID_del_documento",[m
       "tipo": "buff|nerf|actualizaci√≥n",[m
[31m-      "categoria": "nombre_categoria_principal",[m
[31m-      "subtipo": "subtipo_especifico",[m
       "summary": "Resumen conciso del impacto real",[m
       "relevance": n√∫mero_entero_espec√≠fico_1_a_100[m
     }[m
[36m@@ -350,11 +267,9 @@[m [mResponde √öNICAMENTE con JSON v√°lido (sin markdown, sin explicaciones):[m
         for (const resultItem of result) {[m
           const item = reducedBatch.find(b => b.id === resultItem.id);[m
           if (item) {[m
[31m-            all.push({[m
[32m+[m[32m            (results as any).push({[m
               id: resultItem.id,[m
               tipo: resultItem.tipo,[m
[31m-              categoria: resultItem.categoria,[m
[31m-              subtipo: resultItem.subtipo,[m
               summary: resultItem.summary,[m
               relevance: resultItem.relevance[m
             });[m
[36m@@ -397,7 +312,7 @@[m [mResponde √öNICAMENTE con JSON v√°lido (sin markdown, sin explicaciones):[m
       // Mostrar progreso[m
       validResults.forEach((r: ClassificationResult) => {[m
         const emoji = r.tipo === 'buff' ? 'üîº' : r.tipo === 'nerf' ? 'üîΩ' : '‚öôÔ∏è';[m
[31m-        console.log(`  ${emoji} ${r.tipo.toUpperCase()} (${r.relevance}/100) [${r.categoria}/${r.subtipo}]: ${r.summary.substring(0, 80)}...`);[m
[32m+[m[32m        console.log(`  ${emoji} ${r.tipo.toUpperCase()} (${r.relevance}/100): ${r.summary.substring(0, 80)}...`);[m
       });[m
       [m
     } catch (e: any) {[m
[36m@@ -490,8 +405,6 @@[m [mexport async function classifyAndSaveToDatabase(fecha: string): Promise<void> {[m
           fecha: fecha,[m
           titulo: originalDoc.TITULO,[m
           tipo: classification.tipo,[m
[31m-          categoria: classification.categoria,[m
[31m-          subtipo: classification.subtipo,[m
           summary: classification.summary,[m
           relevance: classification.relevance,[m
           contenido: originalDoc.CONTENIDO[m
